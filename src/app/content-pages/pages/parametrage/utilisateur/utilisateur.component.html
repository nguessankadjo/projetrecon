<div class="content-global-utilisateur">
    <div class="header-content">
        <div class="header-left">
            <p>Liste des utilisateurs</p>
        </div>
        <div class="header-rigth">
            <div class="search">
                <nz-input-group [nzSuffix]="suffixIconSearch">
                    <input type="text" style="height: 25px;" nz-input placeholder="Recherche d'un utilisateur" />
                </nz-input-group>
                <ng-template #suffixIconSearch>
                    <span nz-icon nzType="search"></span>
                </ng-template>
            </div>
            <div class="button-create">
                <button nz-button nzType="primary" nzShape="circle" (click)="showModalRegister()">
                  <span nz-icon nzType="plus" nzTheme="outline"></span>
                </button>
            </div>
        </div>
    </div>
    <div class="main-centent">
        <nz-table #smallTable nzSize="middle" [nzData]="ListUser">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Prénoms</th>
                    <th>Identifian</th>
                    <th>E-mail</th>
                    <th>Contact</th>
                    <th>Photo de profil</th>
                    <th>Role</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of smallTable.data">
                    <td>{{ data.nom }}</td>
                    <td>{{ data.prenom }}</td>
                    <td>{{ data.login }}</td>
                    <td>{{ data.email }}</td>
                    <td>{{ data.contact }}</td>
                    <td>{{ data.address }}</td>
                    <td><span [ngClass]="{'bg-warning': data.idRole === 1,
                      'bg-success': data.idRole === 2 }" class="badge bg-warning">
                        {{ data.idRole }}
                        </span>
                    </td>
                    <td style="display: flex;gap: 1rem;">
                        <button (click)="showModalRegister(data)" style="    background: #ff7900;
                        border: none;
                        color: white;justify-content: center;
                        display: flex;font-weight: bold;
                        align-items: center;" nz-button nzType="primary" nzShape="circle">
                      <span nz-icon nzType="edit" nzTheme="outline"></span>
                      </button>
                        <!-- <button style="background:#2e8b05;
                        border: none;
                        color: black;justify-content: center;
                        display: flex;
                        align-items: center;" nz-button nzType="primary" nzShape="circle">
                      <span nz-icon nzType="eye" nzTheme="outline"></span>
                      </button> -->
                        <button (click)="confirmSubmitDeletUser(data)" style="    background: red;
                        border: none;
                        color: black;justify-content: center;
                        display: flex;
                        align-items: center;" nz-button nzType="primary" nzShape="circle"><span nz-icon nzType="delete" nzTheme="outline"></span></button>
                    </td>
                </tr>
            </tbody>
        </nz-table>
    </div>
</div>


<nz-modal [(nzVisible)]="isVisible" [nzTitle]="modalTitle" [nzFooter]="modalFooter" (nzOnCancel)="handleCancel()" [nzMaskClosable]="false" [nzOkLoading]="isOkLoading" nzWidth="60%">
    <ng-template style="font-size: 1rem;" #modalTitle>{{titleModif}}</ng-template>
    <div *nzModalContent>
        <form [formGroup]="validateFormRegister" (ngSubmit)="submitFormRegister()" class="form-content">
            <div class="content-el">
                <div class="login-part-one">
                    <nz-form-item style="margin: 0 0 1px;">
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="nom">Nom</nz-form-label>
                        <nz-form-control [nzSm]="24" [nzXs]="24" nzErrorTip="Entrer un nom svp">
                            <input nz-input formControlName="nom" id="nom" style="width:100% ;  border: 2px solid gray;
                        " />
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="email" nzRequired>E-mail</nz-form-label>
                        <nz-form-control [nzSm]="24" [nzXs]="24" nzErrorTip="Entrer un mail correcte">
                            <input nz-input id="email" formControlName="email" style="width:100% ;  border: 2px solid gray;
                          " (ngModelChange)="updateConfirmValidator()" />
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="password" nzRequired>Password</nz-form-label>
                        <nz-form-control [nzSm]="24" [nzXs]="24" nzErrorTip="Entrer un mot de passe qui vous convient">
                            <input nz-input type="password" style="border: 2px solid gray;" id="password" formControlName="password" (ngModelChange)="updateConfirmValidator()" />
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="checkPassword" nzRequired>Confirm Password</nz-form-label>
                        <nz-form-control [nzSm]="24" [nzXs]="24" [nzErrorTip]="errorTpl">
                            <input nz-input type="password" style="border: 2px solid gray;" formControlName="checkPassword" id="checkPassword" />
                            <ng-template #errorTpl let-control>
                                <ng-container *ngIf="control.hasError('required')">Veuillez confirmer votre mot de passe !</ng-container>
                                <ng-container *ngIf="control.hasError('confirm')">
                                    Les deux mots de passe que vous entrez sont incohérents !
                                </ng-container>
                            </ng-template>
                        </nz-form-control>
                    </nz-form-item>

                </div>

                <div class="login-part-two">
                    <nz-form-item>
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="prenom">Prénoms</nz-form-label>
                        <nz-form-control [nzSm]="24" [nzXs]="24" nzErrorTip="Entrer un  prenom svp">
                            <input nz-input formControlName="prenom" id="prenom" style="border: 2px solid gray;
                          " />
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="login" nzRequired>Identifiant</nz-form-label>
                        <nz-form-control [nzSm]="24" [nzXs]="24" nzErrorTip="Entrer un login svp">
                            <input nz-input id="login" formControlName="login" style="border: 2px solid gray;
                          " (ngModelChange)="updateConfirmValidator()" />
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="contact">Contact</nz-form-label>
                        <nz-form-control [nzSm]="24" [nzXs]="20" nzErrorTip="Entrer un contact svp">
                            <input nz-input style="border: 2px solid gray;
                          " formControlName="contact" id="contact" />
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="contact">Image de profil</nz-form-label>
                        <div style=" width: 100%;">
                            <input type="file" name="uploadedFile" id="uploadedFile" accept="*/*">
                            <label class="uploadedFile" for="uploadedFile">
                            <i class="fas fa-save" style="    margin-right: 1rem;"></i>
                            Joindre un fichier
                          </label>
                            <small style="font-size: 16px; font-weight: 600;"></small>
                        </div>
                    </nz-form-item>

                </div>
            </div>
            <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="idRole">Assigner un rôle à l'utilisateur</nz-form-label>
                <nz-select style="border: 2px solid gray;
                " nzShowSearch nzAllowClear nzPlaceHolder="Select un rôle" nzErrorTip="Selectionner un rôle svp" formControlName="idRole">
                    <nz-option *ngFor="let item of ListRole" nzCustomContent [nzLabel]="item.libRole" [nzValue]="item.idRole">
                        {{item.libRole}}
                    </nz-option>
                </nz-select>
            </nz-form-item>
        </form>
    </div>
    <ng-template #modalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Annuler</button>
        <button nz-button nzType="primary" (click)="handleOkRegiter()" [nzLoading]="isConfirmLoading">{{titleBtn}}</button>
    </ng-template>
</nz-modal>
